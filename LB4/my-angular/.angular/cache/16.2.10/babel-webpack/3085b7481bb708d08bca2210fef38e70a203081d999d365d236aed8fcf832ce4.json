{"ast":null,"code":"import { HttpParams } from '@angular/common/http';\nimport { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class DataService {\n  constructor(http) {\n    this.http = http;\n    this.usersStorage = [{}];\n    this.curUserID = new BehaviorSubject(0);\n    this.curUserID$ = this.curUserID;\n    this.curUserFullName = new BehaviorSubject(\"Гостевой аккаунт\");\n    this.curUserFullName$ = this.curUserFullName;\n  }\n  getUserStorage() {\n    return this.http.get('http://localhost:3000/usersListStorage.json');\n  }\n  // sendUserDialog(firstUserID : number, secondUserID : number) : Observable<string>{\n  //     let ids = [firstUserID, secondUserID];\n  //     ids.sort((a : number, b : number) => {return a-b;});\n  //     let name = \"d\" + ids[0] + \"-\" + ids[1] + \".json\"; \n  //     return this.http.post<string>('http://localhost:3000/sendDialog', {fileName: name, });\n  // }\n  getUserDialog(firstUserID, secondUserID) {\n    let ids = [firstUserID, secondUserID];\n    ids.sort((a, b) => {\n      return a - b;\n    });\n    let name = \"d\" + ids[0] + \"-\" + ids[1] + \".json\";\n    return this.http.post('http://localhost:3000/sendDialog');\n  }\n  changeUserID(newID) {\n    this.curUserID.next(newID);\n  }\n  changeUserFullName(newName) {\n    this.curUserFullName.next(newName);\n  }\n  sendUserListStorage(newList) {\n    console.log(\"DATA\", newList);\n    const params = new HttpParams().set('newUserListParam', JSON.stringify(newList));\n    return this.http.get('http://localhost:3000/changeUserListStorage', {\n      params\n    });\n  }\n  checkParams() {\n    console.log(\"private: \", this.curUserFullName, this.curUserID);\n    console.log(\"public: \", this.curUserFullName$, this.curUserID$);\n  }\n  static #_ = this.ɵfac = function DataService_Factory(t) {\n    return new (t || DataService)(i0.ɵɵinject(i1.HttpClient));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: DataService,\n    factory: DataService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["HttpParams","BehaviorSubject","DataService","constructor","http","usersStorage","curUserID","curUserID$","curUserFullName","curUserFullName$","getUserStorage","get","getUserDialog","firstUserID","secondUserID","ids","sort","a","b","name","post","changeUserID","newID","next","changeUserFullName","newName","sendUserListStorage","newList","console","log","params","set","JSON","stringify","checkParams","_","i0","ɵɵinject","i1","HttpClient","_2","factory","ɵfac","providedIn"],"sources":["/home/azazzzel/LETI2024/WEB/LB4/my-angular/src/app/data.service.ts"],"sourcesContent":["import { HttpClient, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, BehaviorSubject, Subject } from 'rxjs';\n\n\n@Injectable({providedIn: 'root'})\nexport class DataService{\n\n    public usersStorage = [{}];\n\n    public curUserID = new BehaviorSubject(0);\n    public curUserID$ : Observable<number> = this.curUserID;\n\n    public curUserFullName = new BehaviorSubject(\"Гостевой аккаунт\");\n    public curUserFullName$ : Observable<string> = this.curUserFullName;\n\n    constructor(private http: HttpClient){ }\n\n    getUserStorage() : Observable<object>{\n        return this.http.get<object>('http://localhost:3000/usersListStorage.json');\n    }\n\n    // sendUserDialog(firstUserID : number, secondUserID : number) : Observable<string>{\n    //     let ids = [firstUserID, secondUserID];\n    //     ids.sort((a : number, b : number) => {return a-b;});\n    //     let name = \"d\" + ids[0] + \"-\" + ids[1] + \".json\"; \n        \n    //     return this.http.post<string>('http://localhost:3000/sendDialog', {fileName: name, });\n    // }\n\n    getUserDialog(firstUserID : number, secondUserID : number) : Observable<string>{\n        let ids = [firstUserID, secondUserID];\n        ids.sort((a : number, b : number) => {return a-b;});\n        let name = \"d\" + ids[0] + \"-\" + ids[1] + \".json\"; \n        \n        return this.http.post<string>('http://localhost:3000/sendDialog' );\n    }\n\n    changeUserID(newID : number) : void {\n        this.curUserID.next(newID);\n    }\n\n    changeUserFullName(newName : string) : void{\n        this.curUserFullName.next(newName); \n    }\n\n    sendUserListStorage(newList : [{}]) {\n        console.log(\"DATA\", newList);\n        const params = new HttpParams().set('newUserListParam', JSON.stringify(newList));\n        return this.http.get('http://localhost:3000/changeUserListStorage', {params}); \n    }\n\n    checkParams() : void{\n        console.log(\"private: \", this.curUserFullName, this.curUserID);\n        console.log(\"public: \", this.curUserFullName$, this.curUserID$);\n    }\n\n}\n\n"],"mappings":"AAAA,SAAqBA,UAAU,QAAQ,sBAAsB;AAE7D,SAAqBC,eAAe,QAAiB,MAAM;;;AAI3D,OAAM,MAAOC,WAAW;EAUpBC,YAAoBC,IAAgB;IAAhB,KAAAA,IAAI,GAAJA,IAAI;IARjB,KAAAC,YAAY,GAAG,CAAC,EAAE,CAAC;IAEnB,KAAAC,SAAS,GAAG,IAAIL,eAAe,CAAC,CAAC,CAAC;IAClC,KAAAM,UAAU,GAAwB,IAAI,CAACD,SAAS;IAEhD,KAAAE,eAAe,GAAG,IAAIP,eAAe,CAAC,kBAAkB,CAAC;IACzD,KAAAQ,gBAAgB,GAAwB,IAAI,CAACD,eAAe;EAE5B;EAEvCE,cAAcA,CAAA;IACV,OAAO,IAAI,CAACN,IAAI,CAACO,GAAG,CAAS,6CAA6C,CAAC;EAC/E;EAEA;EACA;EACA;EACA;EAEA;EACA;EAEAC,aAAaA,CAACC,WAAoB,EAAEC,YAAqB;IACrD,IAAIC,GAAG,GAAG,CAACF,WAAW,EAAEC,YAAY,CAAC;IACrCC,GAAG,CAACC,IAAI,CAAC,CAACC,CAAU,EAAEC,CAAU,KAAI;MAAE,OAAOD,CAAC,GAACC,CAAC;IAAC,CAAC,CAAC;IACnD,IAAIC,IAAI,GAAG,GAAG,GAAGJ,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGA,GAAG,CAAC,CAAC,CAAC,GAAG,OAAO;IAEhD,OAAO,IAAI,CAACX,IAAI,CAACgB,IAAI,CAAS,kCAAkC,CAAE;EACtE;EAEAC,YAAYA,CAACC,KAAc;IACvB,IAAI,CAAChB,SAAS,CAACiB,IAAI,CAACD,KAAK,CAAC;EAC9B;EAEAE,kBAAkBA,CAACC,OAAgB;IAC/B,IAAI,CAACjB,eAAe,CAACe,IAAI,CAACE,OAAO,CAAC;EACtC;EAEAC,mBAAmBA,CAACC,OAAc;IAC9BC,OAAO,CAACC,GAAG,CAAC,MAAM,EAAEF,OAAO,CAAC;IAC5B,MAAMG,MAAM,GAAG,IAAI9B,UAAU,EAAE,CAAC+B,GAAG,CAAC,kBAAkB,EAAEC,IAAI,CAACC,SAAS,CAACN,OAAO,CAAC,CAAC;IAChF,OAAO,IAAI,CAACvB,IAAI,CAACO,GAAG,CAAC,6CAA6C,EAAE;MAACmB;IAAM,CAAC,CAAC;EACjF;EAEAI,WAAWA,CAAA;IACPN,OAAO,CAACC,GAAG,CAAC,WAAW,EAAE,IAAI,CAACrB,eAAe,EAAE,IAAI,CAACF,SAAS,CAAC;IAC9DsB,OAAO,CAACC,GAAG,CAAC,UAAU,EAAE,IAAI,CAACpB,gBAAgB,EAAE,IAAI,CAACF,UAAU,CAAC;EACnE;EAAC,QAAA4B,CAAA,G;qBAjDQjC,WAAW,EAAAkC,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;EAAA;EAAA,QAAAC,EAAA,G;WAAXtC,WAAW;IAAAuC,OAAA,EAAXvC,WAAW,CAAAwC,IAAA;IAAAC,UAAA,EADC;EAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}